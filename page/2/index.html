<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=0.4.5.2" />






<meta name="description" content="生命不息，折腾不止！！！">
<meta property="og:type" content="website">
<meta property="og:title" content="Shine's blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Shine's blog">
<meta property="og:description" content="生命不息，折腾不止！！！">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shine's blog">
<meta name="twitter:description" content="生命不息，折腾不止！！！">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'hide',
    motion: true
  };
</script>

  <title> Shine's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?6e3e65b6fa6d46bfec86b332d7db0bcb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i class="" style="transform: translateX(100%);"></i></span>
      <span class="site-title">Shine's blog</span>
      <span class="logo-line-after"><i class="" style="transform: translateX(-100%);"></i></span>
    </a>
  </div>
  <p class="site-subtitle">生命不息，折腾不止！！！</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            目录
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/23/Android-camera/" itemprop="url">
                  Android Camera
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-23T11:32:24+08:00" content="2016-09-23">
              2016-09-23
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/23/Android-camera/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/23/Android-camera/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="u4F7F_u7528camera_u62CD_u7167_u57FA_u672C_u6D41_u7A0B"><a href="#u4F7F_u7528camera_u62CD_u7167_u57FA_u672C_u6D41_u7A0B" class="headerlink" title="使用camera拍照基本流程"></a>使用camera拍照基本流程</h1><ol>
<li>Obtain an instance of Camera from open(int).<br>获取相机实例，open指定前后摄像头。</li>
<li>Get existing (default) settings with getParameters().<br>通过getParameters获取相机默认设置参数</li>
<li>If necessary, modify the returned Camera.Parameters object and call setParameters(Camera.Parameters).<br>setParameters设置相机参数</li>
<li>Call setDisplayOrientation(int) to ensure correct orientation of preview.<br>setDisplayOrientation设置预览图像旋转角度</li>
<li>Important: Pass a fully initialized SurfaceHolder to setPreviewDisplay(SurfaceHolder). Without a surface, the camera will be unable to start the preview.<br>显示预览到surfaceview，没有surface相机是不可以预览。</li>
<li>Important: Call startPreview() to start updating the preview surface. Preview must be started before you can take a picture.<br>startPreview开始预览，拍照前一定要预览。</li>
<li>When you want, call takePicture(Camera.ShutterCallback, Camera.PictureCallback, Camera.PictureCallback, Camera.PictureCallback) to capture a photo. Wait for the callbacks to provide the actual image data.<br>takePicture拍照</li>
<li>After taking a picture, preview display will have stopped. To take more photos, call startPreview() again first.<br>拍照后预览将会停止，重拍一定要调用startPreview。</li>
<li>Call stopPreview() to stop updating the preview surface.<br>调用stopPreview停止预览</li>
<li>Important: Call release() to release the camera for use by other applications. Applications should release the camera immediately in onPause() (and re-open() it in onResume()).<br>调用release释放相机。<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> startCamera(SurfaceTexture surface) &#123;</span><br><span class="line">      surface.setDefaultBufferSize(<span class="number">1080</span>, <span class="number">1920</span>);</span><br><span class="line"></span><br><span class="line">      Log.d(<span class="string">"lll"</span>, <span class="string">"open camera begin"</span>);</span><br><span class="line">       <span class="built_in">camera</span> = Camera.<span class="built_in">open</span>(Camera.CameraInfo.CAMERA_FACING_BACK);</span><br><span class="line">      Camera.Parameters params = <span class="built_in">camera</span>.getParameters();</span><br><span class="line">      params.setPreviewSize(<span class="number">1920</span>, <span class="number">1080</span>);</span><br><span class="line">      params.setPreviewFormat(ImageFormat.YV12);</span><br><span class="line">      <span class="built_in">camera</span>.setParameters(params);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">camera</span>.setDisplayOrientation(<span class="number">90</span>);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="built_in">camera</span>.setPreviewTexture(surface);</span><br><span class="line">          <span class="built_in">camera</span>.startPreview();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">final</span> <span class="built_in">boolean</span>[] flag = &#123;<span class="keyword">true</span>&#125;;</span><br><span class="line">      <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[getYuvBuffer(<span class="number">1920</span>, <span class="number">1080</span>)];</span><br><span class="line">      <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">          <span class="built_in">camera</span>.addCallbackBuffer(buffer);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">camera</span>.setPreviewCallbackWithBuffer(<span class="keyword">new</span> Camera.PreviewCallback() &#123;</span><br><span class="line">          @Override</span><br><span class="line">          <span class="keyword">public</span> <span class="keyword">void</span> onPreviewFrame(<span class="built_in">byte</span>[] data, Camera <span class="built_in">camera</span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> (flag[<span class="number">0</span>]) &#123;</span><br><span class="line">                  flag[<span class="number">0</span>] = <span class="keyword">false</span>;</span><br><span class="line">                  Log.d(<span class="string">"lll"</span>, <span class="string">"open camera end"</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="built_in">camera</span>.addCallbackBuffer(data);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> getYuvBuffer(<span class="built_in">int</span> <span class="variable">width</span>, <span class="built_in">int</span> <span class="variable">height</span>) &#123;</span><br><span class="line">      <span class="comment">// stride = ALIGN(width, 16)</span></span><br><span class="line">      <span class="built_in">int</span> stride = (<span class="built_in">int</span>) Math.<span class="built_in">ceil</span>(<span class="variable">width</span> / <span class="number">16.0</span>) * <span class="number">16</span>;</span><br><span class="line">      <span class="comment">// y_size = stride * height</span></span><br><span class="line">      <span class="built_in">int</span> y_size = stride * <span class="variable">height</span>;</span><br><span class="line">      <span class="comment">// c_stride = ALIGN(stride/2, 16)</span></span><br><span class="line">      <span class="built_in">int</span> c_stride = (<span class="built_in">int</span>) Math.<span class="built_in">ceil</span>(<span class="variable">width</span> / <span class="number">32.0</span>) * <span class="number">16</span>;</span><br><span class="line">      <span class="comment">// c_size = c_stride * height/2</span></span><br><span class="line">      <span class="built_in">int</span> c_size = c_stride * <span class="variable">height</span> / <span class="number">2</span>;</span><br><span class="line">      <span class="comment">// size = y_size + c_size * 2</span></span><br><span class="line">      <span class="keyword">return</span> y_size + c_size * <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="u4F7F_u7528camera_u5F55_u89C6_u9891_u57FA_u672C_u6D41_u7A0B"><a href="#u4F7F_u7528camera_u5F55_u89C6_u9891_u57FA_u672C_u6D41_u7A0B" class="headerlink" title="使用camera录视频基本流程"></a>使用camera录视频基本流程</h1><p>Open Camera - Use the Camera.open() to get an instance of the camera object.<br>Connect Preview - Prepare a live camera image preview by connecting a SurfaceView to the camera using Camera.setPreviewDisplay().<br>Start Preview - Call Camera.startPreview() to begin displaying the live camera images.<br>Start Recording Video - The following steps must be completed in order to successfully record video:<br>Unlock the Camera - Unlock the camera for use by MediaRecorder by calling Camera.unlock().<br>Configure MediaRecorder - Call in the following MediaRecorder methods in this order. For more information, see the MediaRecorder reference documentation.<br>setCamera() - Set the camera to be used for video capture, use your application’s current instance of Camera.<br>setAudioSource() - Set the audio source, use MediaRecorder.AudioSource.CAMCORDER.<br>setVideoSource() - Set the video source, use MediaRecorder.VideoSource.CAMERA.<br>Set the video output format and encoding. For Android 2.2 (API Level 8) and higher, use the MediaRecorder.setProfile method, and get a profile instance using CamcorderProfile.get(). For versions of Android prior to 2.2, you must set the video output format and encoding parameters:<br>setOutputFormat() - Set the output format, specify the default setting or MediaRecorder.OutputFormat.MPEG_4.<br>setAudioEncoder() - Set the sound encoding type, specify the default setting or MediaRecorder.AudioEncoder.AMR_NB.<br>setVideoEncoder() - Set the video encoding type, specify the default setting or MediaRecorder.VideoEncoder.MPEG_4_SP.<br>setOutputFile() - Set the output file, use getOutputMediaFile(MEDIA_TYPE_VIDEO).toString() from the example method in the Saving Media Files section.<br>setPreviewDisplay() - Specify the SurfaceView preview layout element for your application. Use the same object you specified for Connect Preview.<br>Caution: You must call these MediaRecorder configuration methods in this order, otherwise your application will encounter errors and the recording will fail.</p>
<p>Prepare MediaRecorder - Prepare the MediaRecorder with provided configuration settings by calling MediaRecorder.prepare().<br>Start MediaRecorder - Start recording video by calling MediaRecorder.start().<br>Stop Recording Video - Call the following methods in order, to successfully complete a video recording:<br>Stop MediaRecorder - Stop recording video by calling MediaRecorder.stop().<br>Reset MediaRecorder - Optionally, remove the configuration settings from the recorder by calling MediaRecorder.reset().<br>Release MediaRecorder - Release the MediaRecorder by calling MediaRecorder.release().<br>Lock the Camera - Lock the camera so that future MediaRecorder sessions can use it by calling Camera.lock(). Starting with Android 4.0 (API level 14), this call is not required unless the MediaRecorder.prepare() call fails.<br>Stop the Preview - When your activity has finished using the camera, stop the preview using Camera.stopPreview().<br>Release Camera - Release the camera so that other applications can use it by calling Camera.release().<br>Note: It is possible to use MediaRecorder without creating a camera preview first and skip the first few steps of this process. However, since users typically prefer to see a preview before starting a recording, that process is not discussed here.</p>
<p>Tip: If your application is typically used for recording video, set setRecordingHint(boolean) to true prior to starting your preview. This setting can help reduce the time it takes to start recording.<br>/**<br>private boolean prepareVideoRecorder(){</p>
<pre><code>mCamera = getCameraInstance();
mMediaRecorder = new MediaRecorder();

// Step 1: Unlock and set camera to MediaRecorder
mCamera.unlock();
mMediaRecorder.setCamera(mCamera);

// Step 2: Set sources
mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

// Step 3: Set a CamcorderProfile (requires API Level 8 or higher)
mMediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_HIGH));

// Step 4: Set output file
mMediaRecorder.setOutputFile(getOutputMediaFile(MEDIA_TYPE_VIDEO).toString());

// Step 5: Set the preview output
mMediaRecorder.setPreviewDisplay(mPreview.getHolder().getSurface());

// Step 6: Prepare configured MediaRecorder
try {
    mMediaRecorder.prepare();
} catch (IllegalStateException e) {
    Log.d(TAG, &quot;IllegalStateException preparing MediaRecorder: &quot; + e.getMessage());
    releaseMediaRecorder();
    return false;
} catch (IOException e) {
    Log.d(TAG, &quot;IOException preparing MediaRecorder: &quot; + e.getMessage());
    releaseMediaRecorder();
    return false;
}
return true;
</code></pre><p>}<br>**/</p>
<h1 id="u5F00_u53D1_u7B14_u8BB0"><a href="#u5F00_u53D1_u7B14_u8BB0" class="headerlink" title="开发笔记"></a>开发笔记</h1><h2 id="camera_orientation"><a href="#camera_orientation" class="headerlink" title="camera orientation"></a>camera orientation</h2><p>CameraInfo.orientation 是设备和相机之间的角度</p>
<ol>
<li><p>setDisplayOrientation(int) 设置预览图像旋转角度<br>只对预览起作用（详见第5条）</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="type">void</span> setCameraDisplayOrientation(<span class="type">Activity</span> activity,</span><br><span class="line">                                               <span class="type">int</span> cameraId, android.hardware.<span class="type">Camera</span> camera) &#123;</span><br><span class="line">    android.hardware.<span class="type">Camera</span>.<span class="type">CameraInfo</span> info =</span><br><span class="line">            new android.hardware.<span class="type">Camera</span>.<span class="type">CameraInfo</span>();</span><br><span class="line">    android.hardware.<span class="type">Camera</span>.getCameraInfo(cameraId, info);</span><br><span class="line">    <span class="type">int</span> rotation = activity.getWindowManager().getDefaultDisplay()</span><br><span class="line">            .getRotation();</span><br><span class="line">    <span class="type">int</span> degrees = <span class="number">0</span>;</span><br><span class="line">    switch (rotation) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Surface</span>.<span class="type">ROTATION_0</span>:</span><br><span class="line">            degrees = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Surface</span>.<span class="type">ROTATION_90</span>:</span><br><span class="line">            degrees = <span class="number">90</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Surface</span>.<span class="type">ROTATION_180</span>:</span><br><span class="line">            degrees = <span class="number">180</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Surface</span>.<span class="type">ROTATION_270</span>:</span><br><span class="line">            degrees = <span class="number">270</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="literal">result</span>;</span><br><span class="line">    <span class="keyword">if</span> (info.facing == <span class="type">Camera</span>.<span class="type">CameraInfo</span>.<span class="type">CAMERA_FACING_FRONT</span>) &#123;</span><br><span class="line">        <span class="literal">result</span> = (info.orientation + degrees) % <span class="number">360</span>;</span><br><span class="line">        <span class="literal">result</span> = (<span class="number">360</span> - <span class="literal">result</span>) % <span class="number">360</span>;  // compensate the mirror</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;  // back-facing</span><br><span class="line">        <span class="literal">result</span> = (info.orientation - degrees + <span class="number">360</span>) % <span class="number">360</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    camera.setDisplayOrientation(<span class="literal">result</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>setRotation 设置拍照图片旋转角度</p>
</li>
</ol>
<p>通过设置相机setRotation旋转照片<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">    * Called when the orientation of the device has changed.</span><br><span class="line">    * orientation parameter is in degrees, ranging from 0 to 359.</span><br><span class="line">    * orientation is 0 degrees when the device is oriented in its natural position,</span><br><span class="line">    * 90 degrees when its left side is at the top, 180 degrees when it is upside down, </span><br><span class="line">    * and 270 degrees when its right side is to the top.</span><br><span class="line">    * &#123;@link #ORIENTATION_UNKNOWN&#125; is returned when the device is close to flat</span><br><span class="line">    * and the orientation cannot be determined.</span><br><span class="line">    *</span><br><span class="line">    * @param orientation The new orientation of the device.</span><br><span class="line">    *</span><br><span class="line">    *  @see #ORIENTATION_UNKNOWN</span><br><span class="line">    */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOrientationChanged</span><span class="params">(<span class="keyword">int</span> orientation)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (orientation == ORIENTATION_UNKNOWN) <span class="keyword">return</span>;</span><br><span class="line">       android.hardware.Camera.CameraInfo info =</span><br><span class="line">               <span class="keyword">new</span> android.hardware.Camera.CameraInfo();</span><br><span class="line">       android.hardware.Camera.getCameraInfo(cameraId, info);</span><br><span class="line">       orientation = (orientation + <span class="number">45</span>) / <span class="number">90</span> * <span class="number">90</span>;</span><br><span class="line">       <span class="keyword">int</span> rotation = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">if</span> (info.facing == CameraInfo.CAMERA_FACING_FRONT) &#123;</span><br><span class="line">           rotation = (info.orientation - orientation + <span class="number">360</span>) % <span class="number">360</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;  <span class="comment">// back-facing camera</span></span><br><span class="line">           rotation = (info.orientation + orientation) % <span class="number">360</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       mParameters.setRotation(rotation);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>拍照成功后获得bytes，从exif中获取照片旋转角度<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">ORIENTATION_NORMAL</span><br><span class="line">Constant Value: 1 (0x00000001)</span><br><span class="line"></span><br><span class="line">ORIENTATION_ROTATE_180</span><br><span class="line">Constant Value: 3 (0x00000003)</span><br><span class="line"></span><br><span class="line">ORIENTATION_ROTATE_270</span><br><span class="line">Constant Value: 8 (0x00000008)</span><br><span class="line"></span><br><span class="line">ORIENTATION_ROTATE_90</span><br><span class="line">Constant Value: 6 (0x00000006)</span><br><span class="line">**/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function">ExifInterface <span class="title">getExifInterface</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (exif == <span class="keyword">null</span>) &#123;</span><br><span class="line">            exif = <span class="keyword">new</span> ExifInterface();</span><br><span class="line"></span><br><span class="line">            exif.readExif(jpegOriginal);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (exif);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getOrientation</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ExifTag tag = getExifInterface().getTag(ExifInterface.TAG_ORIENTATION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (tag == <span class="keyword">null</span> ? -<span class="number">1</span> : tag.getValueAsInt(-1));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>旋转照片<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Matrix</span> <span class="keyword">matrix</span>=new <span class="literal">Matrix</span>();</span><br><span class="line"><span class="keyword">matrix</span>.reset();</span><br><span class="line"><span class="keyword">matrix</span>.postRotate(degrees);</span><br><span class="line">dstBmp=Bitmap.createBitmap(srcBmp, 0, 0, srcBmp.getWidth(), srcBmp.getHeight(), <span class="keyword">matrix</span>, true);</span><br></pre></td></tr></table></figure></p>
<ol>
<li>setPreviewSize设置预览图像分辨率，setPictureSize拍照分辨率<br>设置的分辨率不支持会抛异常<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取预览支持的分辨率</span></span><br><span class="line">cameraParameters.<span class="function"><span class="title">getSupportedPreviewSizes</span><span class="params">()</span></span></span><br><span class="line"><span class="comment">//获取拍照支持的分辨率 </span></span><br><span class="line">cameraParameters.<span class="function"><span class="title">getSupportedPictureSizes</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="u66DD_u5149_u8FC7_u9AD8"><a href="#u66DD_u5149_u8FC7_u9AD8" class="headerlink" title="曝光过高"></a>曝光过高</h2><p>预览帧数过低会导致部分机型曝光过高，解决方案是录视频时降低帧率。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/20/RxJava/" itemprop="url">
                  RxJava
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-20T15:19:32+08:00" content="2016-09-20">
              2016-09-20
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/20/RxJava/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/20/RxJava/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <h1 id="RxJava__u7684_u89C2_u5BDF_u8005_u6A21_u5F0F"><a href="#RxJava__u7684_u89C2_u5BDF_u8005_u6A21_u5F0F" class="headerlink" title="RxJava 的观察者模式"></a>RxJava 的观察者模式</h1><p>RxJava 有四个基本概念：Observable (可观察者，即被观察者)、 Observer (观察者)、 subscribe (订阅)、事件。Observable 和 Observer 通过 subscribe() 方法实现订阅关系，从而 Observable 可以在需要的时候发出事件来通知 Observer。</p>
<p>与传统观察者模式不同， RxJava 的事件回调方法除了普通事件 onNext() （相当于 onClick() / onEvent()）之外，还定义了两个特殊的事件：onCompleted() 和 onError()。</p>
<ul>
<li>onCompleted(): 事件队列完结。RxJava 不仅把每个事件单独处理，还会把它们看做一个队列。RxJava 规定，当不会再有新的onNext() 发出时，需要触发 onCompleted() 方法作为标志。</li>
<li>onError(): 事件队列异常。在事件处理过程中出异常时，onError() 会被触发，同时队列自动终止，不允许再有事件发出。</li>
<li>在一个正确运行的事件序列中, onCompleted() 和 onError() 有且只有一个，并且是事件序列中的最后一个。需要注意的是，onCompleted() 和 onError() 二者也是互斥的，即在队列中调用了其中一个，就不应该再调用另一个。</li>
</ul>
<p>create() 方法是 RxJava 最基本的创造事件序列的方法。基于这个方法， RxJava 还提供了一些方法用来快捷创建事件队列，例如：</p>
<ul>
<li>just(T…): 将传入的参数依次发送出来。<br>Observable observable = Observable.just(“Hello”, “Hi”, “Aloha”);</li>
<li>from(T[]) / from(Iterable&lt;? extends T&gt;) : 将传入的数组或 Iterable 拆分成具体对象后，依次发送出来。</li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/09/20/RxJava/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/ViewPager的数据更新/" itemprop="url">
                  ViewPager的数据更新
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-19T11:11:52+08:00" content="2016-09-19">
              2016-09-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/19/ViewPager的数据更新/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/19/ViewPager的数据更新/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p>ViewPager的更新通过的PagerAdapter中的notifyDataSetChanged方法，可以增加、删除或排序，但不可以像RecycleView更新view。<br><strong>官方文档：</strong><br>PagerAdapter supports data set changes. Data set changes must occur on the main thread and must end with a call to {@link #notifyDataSetChanged()} similar to AdapterView adapters derived from {@link android.widget.BaseAdapter}. A data set change may involve pages being added, removed, or changing position. The ViewPager will keep the current page active provided the adapter implements the method {@link #getItemPosition(Object)}.</p>
<p>更新后ViewPager是否保持当前页存活，通过adapter实现getItemPosition方法进行判断。<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"> <span class="keyword">*</span> Called when the host view is attempting to determine if an item's position</span><br><span class="line"> <span class="keyword">*</span> has changed. Returns &#123;<span class="comment">@link #POSITION_UNCHANGED&#125; if the position of the given</span></span><br><span class="line"> <span class="keyword">*</span> item has not changed or &#123;<span class="comment">@link #POSITION_NONE&#125; if the item is no longer present</span></span><br><span class="line"> <span class="keyword">*</span> in the adapter.</span><br><span class="line"> <span class="keyword">*</span></span><br><span class="line"> <span class="keyword">*</span> <span class="variable">&lt;p&gt;</span>The default implementation assumes that items will never</span><br><span class="line"> <span class="keyword">*</span> change position and always returns &#123;<span class="comment">@link #POSITION_UNCHANGED&#125;.</span></span><br><span class="line"> <span class="keyword">*</span></span><br><span class="line"> <span class="keyword">*</span> <span class="comment">@param object Object representing an item, previously returned by a call to</span></span><br><span class="line"> <span class="keyword">*</span>               &#123;<span class="comment">@link #instantiateItem(View, int)&#125;.</span></span><br><span class="line"> <span class="keyword">*</span> <span class="comment">@return object's new position index from [0, &#123;@link #getCount()&#125;),</span></span><br><span class="line"> <span class="keyword">*</span>         &#123;<span class="comment">@link #POSITION_UNCHANGED&#125; if the object's position has not changed,</span></span><br><span class="line"> <span class="keyword">*</span>         or &#123;<span class="comment">@link #POSITION_NONE&#125; if the item is no longer present.</span></span><br><span class="line"> <span class="keyword">*</span>/</span><br><span class="line">public int getItemPosition(Object object) &#123;</span><br><span class="line">    return POSITION_UNCHANGED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>POSITION_UNCHANGED不更新，POSITION_NONE更新。<br>所以重写getItemPosition方法，返回POSITION_NONE，可以先实现通过notifyDataSetChanged进行页面更新。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/09/19/ViewPager的数据更新/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/18/java-线程池/" itemprop="url">
                  Java 线程池
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-18T14:29:35+08:00" content="2016-09-18">
              2016-09-18
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/18/java-线程池/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/18/java-线程池/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h1><p><strong>Executor</strong>是一个顶层接口，在它里面只声明了一个方法execute(Runnable)；<br><strong>ExecutorService</strong>是一个接口，继承了Executor接口，并声明了一些方法：submit、invokeAll、invokeAny以及shutDown等；<br><strong>AbstractExecutorService</strong>是一个抽象类，实现了ExecutorService接口，基本实现了ExecutorService中声明的所有方法；<br><strong>ThreadPoolExecutor</strong>继承了类AbstractExecutorService。</p>
<p><strong>在ThreadPoolExecutor类中有几个非常重要的方法：</strong><br><strong>execute()</strong><br>execute()方法实际上是Executor中声明的方法，在ThreadPoolExecutor进行了具体的实现，这个方法是ThreadPoolExecutor的核心方法，通过这个方法可以向线程池提交一个任务，交由线程池去执行。<br><strong>submit()</strong><br>submit()方法是在ExecutorService中声明的方法，在AbstractExecutorService就已经有了具体的实现，在ThreadPoolExecutor中并没有对其进行重写，这个方法也是用来向线程池提交任务的，但是它和execute(）方法不同，它能够返回任务执行的结果，去看submit()方法的实现，会发现它实际上还是调用的execute()方法，只不过它利用了Future来获取任务执行结果。<br><strong>shutdown()</strong><br><strong>shutdownNow()</strong><br>shutdown()和shutdownNow()是用来关闭线程池的。</p>
<h1 id="Executors"><a href="#Executors" class="headerlink" title="Executors"></a>Executors</h1><p>Java通过Executors提供四种线程池，分别为：<br><strong>newCachedThreadPool</strong><br>创建一个可缓存线程池，如果线程池长度超过处理需要，可灵活回收空闲线程，若无可回收，则新建线程。<br><strong>newFixedThreadPool</strong><br>创建一个定长线程池，可控制线程最大并发数，超出的线程会在队列中等待。<br><strong>newScheduledThreadPool</strong><br>创建一个定长线程池，支持定时及周期性任务执行。<br><strong>newSingleThreadExecutor</strong><br>创建一个单线程化的线程池，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序(FIFO, LIFO, 优先级)执行。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/12/DialogFragment/" itemprop="url">
                  DialogFragment
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-12T18:35:43+08:00" content="2016-09-12">
              2016-09-12
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/12/DialogFragment/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/12/DialogFragment/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">void</span> showDialog() &#123;</span><br><span class="line">    mStackLevel++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DialogFragment.show() will take care of adding the fragment</span></span><br><span class="line">    <span class="comment">// in a transaction.  We also want to remove any currently showing</span></span><br><span class="line">    <span class="comment">// dialog, so make our own transaction and take care of that here.</span></span><br><span class="line">    FragmentTransaction <span class="literal">ft</span> = getFragmentManager()<span class="built_in">.</span>beginTransaction();</span><br><span class="line">    Fragment prev = getFragmentManager()<span class="built_in">.</span>findFragmentByTag(<span class="string">"dialog"</span>);</span><br><span class="line">    <span class="keyword">if</span> (prev != <span class="built_in">null</span>) &#123;</span><br><span class="line">        <span class="literal">ft</span><span class="built_in">.</span>remove(prev);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="literal">ft</span><span class="built_in">.</span>addToBackStack(<span class="built_in">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create and show the dialog.</span></span><br><span class="line">    DialogFragment newFragment = MyDialogFragment<span class="built_in">.</span>newInstance(mStackLevel);</span><br><span class="line">    newFragment<span class="built_in">.</span>show(<span class="literal">ft</span>, <span class="string">"dialog"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAlertDialogFragment</span> <span class="keyword">extends</span> <span class="title">DialogFragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyAlertDialogFragment <span class="title">newInstance</span><span class="params">(<span class="keyword">int</span> title)</span> </span>&#123;</span><br><span class="line">        MyAlertDialogFragment frag = <span class="keyword">new</span> MyAlertDialogFragment();</span><br><span class="line">        Bundle args = <span class="keyword">new</span> Bundle();</span><br><span class="line">        args.putInt(<span class="string">"title"</span>, title);</span><br><span class="line">        frag.setArguments(args);</span><br><span class="line">        <span class="keyword">return</span> frag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dialog <span class="title">onCreateDialog</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> title = getArguments().getInt(<span class="string">"title"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AlertDialog.Builder(getActivity())</span><br><span class="line">                .setIcon(R.drawable.alert_dialog_icon)</span><br><span class="line">                .setTitle(title)</span><br><span class="line">                .setPositiveButton(R.string.alert_dialog_ok,</span><br><span class="line">                    <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> whichButton)</span> </span>&#123;</span><br><span class="line">                            ((FragmentAlertDialog)getActivity()).doPositiveClick();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">                .setNegativeButton(R.string.alert_dialog_cancel,</span><br><span class="line">                    <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> whichButton)</span> </span>&#123;</span><br><span class="line">                            ((FragmentAlertDialog)getActivity()).doNegativeClick();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">                .create();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/12/Android透明度16进制值/" itemprop="url">
                  Android 透明度百分比对应的 十六进制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-12T10:25:28+08:00" content="2016-09-12">
              2016-09-12
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/12/Android透明度16进制值/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/12/Android透明度16进制值/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <pre><code>百分比:0%  HEX: 00
百分比:1%  HEX: 30
百分比:2%  HEX: 50
百分比:3%  HEX: 80
百分比:4%  HEX: A0
百分比:5%  HEX: D0
百分比:6%  HEX: F0
百分比:7%  HEX: 12
百分比:8%  HEX: 14
百分比:9%  HEX: 17
百分比:10%  HEX: 1A
百分比:11%  HEX: 1C
百分比:12%  HEX: 1F
百分比:13%  HEX: 21
百分比:14%  HEX: 24
百分比:15%  HEX: 26
百分比:16%  HEX: 29
百分比:17%  HEX: 2B
百分比:18%  HEX: 2E
百分比:19%  HEX: 30
百分比:20%  HEX: 33
百分比:21%  HEX: 36
百分比:22%  HEX: 38
百分比:23%  HEX: 3B
百分比:24%  HEX: 3D
百分比:25%  HEX: 40
百分比:26%  HEX: 42
百分比:27%  HEX: 45
百分比:28%  HEX: 47
百分比:29%  HEX: 4A
百分比:30%  HEX: 4D
百分比:31%  HEX: 4F
百分比:32%  HEX: 52
百分比:33%  HEX: 54
百分比:34%  HEX: 57
百分比:35%  HEX: 59
百分比:36%  HEX: 5C
百分比:37%  HEX: 5E
百分比:38%  HEX: 61
百分比:39%  HEX: 63
百分比:40%  HEX: 66
百分比:41%  HEX: 69
百分比:42%  HEX: 6B
百分比:43%  HEX: 6E
百分比:44%  HEX: 70
百分比:45%  HEX: 73
百分比:46%  HEX: 75
百分比:47%  HEX: 78
百分比:48%  HEX: 7A
百分比:49%  HEX: 7D
百分比:50%  HEX: 80
百分比:51%  HEX: 82
百分比:52%  HEX: 85
百分比:53%  HEX: 87
百分比:54%  HEX: 8A
百分比:55%  HEX: 8C
百分比:56%  HEX: 8F
百分比:57%  HEX: 91
百分比:58%  HEX: 94
百分比:59%  HEX: 96
百分比:60%  HEX: 99
百分比:61%  HEX: 9C
百分比:62%  HEX: 9E
百分比:63%  HEX: A1
百分比:64%  HEX: A3
百分比:65%  HEX: A6
百分比:66%  HEX: A8
百分比:67%  HEX: AB
百分比:68%  HEX: AD
百分比:69%  HEX: B0
百分比:70%  HEX: B3
百分比:71%  HEX: B5
百分比:72%  HEX: B8
百分比:73%  HEX: BA
百分比:74%  HEX: BD
百分比:75%  HEX: BF
百分比:76%  HEX: C2
百分比:77%  HEX: C4
百分比:78%  HEX: C7
百分比:79%  HEX: C9
百分比:80%  HEX: CC
百分比:81%  HEX: CF
百分比:82%  HEX: D1
百分比:83%  HEX: D4
百分比:84%  HEX: D6
百分比:85%  HEX: D9
百分比:86%  HEX: DB
百分比:87%  HEX: DE
百分比:88%  HEX: E0
百分比:89%  HEX: E3
百分比:90%  HEX: E6
百分比:91%  HEX: E8
百分比:92%  HEX: EB
百分比:93%  HEX: ED
百分比:94%  HEX: F0
百分比:95%  HEX: F2
百分比:96%  HEX: F5
百分比:97%  HEX: F7
百分比:98%  HEX: FA
百分比:99%  HEX: FC
百分比:100%  HEX: FF
</code></pre><p>格式如#00FFFFFF，前两位代表不透明度的十六进制。00表示完全透明，FF就是全不透明。依次递增。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/08/release和debug共存/" itemprop="url">
                  release和debug包共存
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-08T20:44:28+08:00" content="2016-09-08">
              2016-09-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/08/release和debug共存/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/08/release和debug共存/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p>PackageName，所有的Android应用程序都有一个包名。包名是设备上的这个应用程序的唯一标识，所以应用共存从包名下手。</p>
<h1 id="1-_u4FEE_u6539AndroidManifest_u4E2Dpackage"><a href="#1-_u4FEE_u6539AndroidManifest_u4E2Dpackage" class="headerlink" title="1.修改AndroidManifest中package"></a>1.修改AndroidManifest中package</h1><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;manifest <span class="string">xmlns:</span>android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="keyword">package</span>=<span class="string">"com.example.my.app"</span></span><br><span class="line"><span class="label">    android:</span>versionCode=<span class="string">"1"</span></span><br><span class="line"><span class="label">    android:</span>versionName=<span class="string">"1.0"</span> &gt;</span><br></pre></td></tr></table></figure>
<p>大量的包、R.java的重命名，不推荐。</p>
<h1 id="2-__u914D_u7F6E_u5E94_u7528_u7684build-gradle_u6587_u4EF6"><a href="#2-__u914D_u7F6E_u5E94_u7528_u7684build-gradle_u6587_u4EF6" class="headerlink" title="2. 配置应用的build.gradle文件"></a>2. 配置应用的build.gradle文件</h1><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">        ...</span><br><span class="line">        buildTypes&#123;</span><br><span class="line">            debug&#123;</span><br><span class="line">                //在编译打包时会给包名加上后缀</span><br><span class="line">                applicationIdSuffix<span class="string">'.debug'</span></span><br><span class="line">            &#125;</span><br><span class="line">            release&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/09/08/release和debug共存/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/08/parcelable-to-bytes/" itemprop="url">
                  parcelable to bytes
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-09-08T10:07:52+08:00" content="2016-09-08">
              2016-09-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/08/parcelable-to-bytes/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/08/parcelable-to-bytes/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>实现parcelable接口的可序列化对象与byte[]相互转换，从而实现保存对象到文件或数据库。</p>
<p>parcelable to bytes<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Parcel parcel = Parcel.obtain()<span class="comment">;</span></span><br><span class="line">recorderConfiguration.writeToParcel(parcel, 0)<span class="comment">;</span></span><br><span class="line">byte[] bundleBytes = parcel.marshall()<span class="comment">;</span></span><br><span class="line">parcel.recycle()<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>bytes to parcelable<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">byte[] configBytes <span class="comment">;</span></span><br><span class="line">Parcel parcel = Parcel.obtain()<span class="comment">;</span></span><br><span class="line">parcel.unmarshall(configBytes, 0, configBytes.length)<span class="comment">;</span></span><br><span class="line">parcel.setDataPosition(0)<span class="comment">;</span></span><br><span class="line">request.recorderConfiguration = new RecorderConfiguration(parcel)<span class="comment">;</span></span><br><span class="line">parcel.recycle()<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/08/preload-video/" itemprop="url">
                  视频预加载
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-08-08T16:11:58+08:00" content="2016-08-08">
              2016-08-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/08/preload-video/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/08/preload-video/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p>同时播放多个视频时，播放完上一个视频切换到下一个视频，需要MediaPlayer先释放上一个视频，然后加载下一个视频，这时候难免会有一会卡顿出现；我解决方案是：通过MediaPlayer渲染到SurfaceView去播放视频，使用2个MediaPlayer，当第一个视频准备好时，去预加载下一个视频，减少MediaPlayer释放和加载视频消耗的时间。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/08/08/preload-video/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/04/Drawable-Resources/" itemprop="url">
                  Drawable Resources
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-08-04T12:24:42+08:00" content="2016-08-04">
              2016-08-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/04/Drawable-Resources/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/04/Drawable-Resources/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p>Drawable Resources</p>
<ul>
<li>Bitmap File</li>
<li>.9.png</li>
<li>Layer List</li>
<li>selector</li>
<li>Level List</li>
<li>Clip Drawable</li>
<li>Scale Drawable</li>
<li>Shape Drawable</li>
<li>animation-list
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/08/04/Drawable-Resources/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Shine Lee" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Shine Lee</p>
        </div>
        <p class="site-description motion-element" itemprop="description">生命不息，折腾不止！！！</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">35</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">2</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">9</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ljyao" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/3715142347" target="_blank">
                  
                    <i class="fa fa-globe"></i> weibo
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shine Lee</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"shinelee"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     


    
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
